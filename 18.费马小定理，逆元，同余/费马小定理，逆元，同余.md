# 费马小定理，逆元，同余

- [费马小定理，逆元，同余](#费马小定理逆元同余)
  - [同余](#同余)
    - [同余的表示](#同余的表示)
    - [同余的性质](#同余的性质)
  - [逆元](#逆元)
    - [求解逆元](#求解逆元)

## 同余

### 同余的表示

若 $a \bmod m = b \bmod m$，则我们称 $a, b$ 同余，记作 $a \equiv b \bmod m$。

注意：c++中，一个负数 mod 另一个数结果还是负数。如 $-11 \% 3 = -2$。而在数学中， $-11 \% 3 = 1$

若 $a \equiv b \bmod m$，则 $m | (a - b), a - b = km (k \in \Z)$，其中 $\Z$ 表示整数集合

### 同余的性质

- 自反性： $a \equiv a (\bmod m)$
- 对称性：若 $a \equiv b (\bmod m)$，则 $b \equiv a (\bmod m)$
- 传递性：若 $a \equiv b (\bmod m), b \equiv c (\bmod m)$，则 $a \equiv c (\bmod m)$

类似等式，在同余式的两边同时进行相同的线性运算也不影响结果。

如：

$$
a \equiv b (\bmod m), c \equiv d (\bmod m)\\
\Downarrow \\
a \pm c \equiv b \pm d (\bmod m) \\
a \times c \equiv b \times d (\bmod m)
$$

## 逆元

当 $ab \equiv 1 (\bmod m)$，则称在模 $m$ 意义下 $a, b$ 互为逆元。

可以将 $b$ 记作 $a^{-1}$

### 求解逆元

求解模 $m$ 意义下的逆元，相当于求解 $ax \equiv 1 (\bmod m)$ 中的 $x$。

可以发现，当 $a$ 和 $m$ 互质时，原方程才有解，**即 $a$ 和 $m$ 互质时， $a$ 存在逆元**。

由于使用扩展欧几里得算法求解过于复杂，下面将会介绍一种更为简单地方法。

若 $gcd(a, p) = 1$，则 $a^{p - 1} \equiv 1 (\bmod p), p \in \mathbb P$，其中 $\mathbb P$ 表示质数集合。

根据这一定理，我们可以发现 $a \times a^{p - 2} \equiv 1 (\bmod p)$

所以，在模 $p$ 的意义下， $a$ 与 $a^{p - 2}$ 互为逆元。

故可以用快速幂来求解逆元，时间复杂度为 $O(\log m)$

需要注意的是，这种方法只适用于模数为质数的情况。非质数的情况需要用扩展欧几里得算法求解。
